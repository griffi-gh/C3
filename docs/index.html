<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="icon" type="image/png" href="favicon.png"/>
		<title>C3 Documentation</title>
		<link rel="stylesheet" href="style.css">
	</head>
	<body>
		<main>
			<header>
				<div id="logo-wrapper">
					<img src="logo.png" id="logo">
				</div>
				<div id="name">
					<h1>The C3 CPU Architecure</h1>
					<span>
						<a href="c3doc.txt">View old docs</a>
						&nbsp;
						<a href="https://github.com/griffi-gh/C3">GitHub</a>
					</span>
				</div>
			</header>
			<div class="line"></div>
			<div class="spacer-v"></div>
			<div class="kinda-centered">
				<h2>Info</h2>
				<div class="tab">
					C3 (<b>C</b>PU<b>3</b>) is a simple 16-bit processor architecture.<br>
				</div>
				<h2 id="_registers">Registers</h2>
				<div class="tab">
					<ul>
						<li>4 (16 bit) general-purpose registers: <b>A, B, C and D</b></li>
						<li>
							2 binary flag registers (<b>Z</b>ero and <b>C</b>arry)<br>
							Zero register gets set if last alu operation result is 0
							Carry gets set if last apu operation cases an overflow
						</li>
						<li>1 <a href="#_io">I/O</a> register: IO_OUT (Write-only)</li>
					</ul>
				</div>
				<h2 id="_mmap">Memory map</h2>
				<div class="tab">
					<i>TODO</i>
				</div>
				<h2 id="_io">I/O</h2>
				<div class="tab">
					C3 can have up to 255 I/O ports.<br>
					Connector pins:
					<table>
					  <tr>
							<th>Name</td>
							<th>Type</td>
							<th>Description</td>
					  </tr>
					  <tr>
							<td>IO_CLK</td>
							<td class="center-text">Output</td>
							<td>Clock</td>
					  </tr>
					  <tr>
							<td>IO_TRIGGER</td>
							<td class="center-text">Output</td>
							<td>Can be used to end a pulse to the I/O device (<a href="#_io_trig">IOTRIG</a>)</td>
					  </tr>
					  <tr>
							<td>IO_OUT</td>
							<td class="center-text">Output</td>
							<td>Value of the IO_OUT register (<a href="#_io_write">IOWRT</a>)</td>
					  </tr>
					  <tr>
							<td>IO_WAKE</td>
							<td class="center-text">Input</td>
							<td>Un<a href="#_i_halt">HALT</a> the CPU</td>
					  </tr>
					  <tr>
							<td>IO_IN</td>
							<td class="center-text">Input</td>
							<td>Value for the <a href="#_io_read">IOREAD</a> instr</td>
					  </tr>
					</table>
				</div>
				<h2 id="_instr_format">Instruction encoding</h2>
				<div class="tab">
					<div>
						<div class="inline code">
							<span class="instr-u">uuuuuuuu</span><!--
							--><span class="instr-s">s</span><!--
							--><span class="instr-r">rr</span><!--
							--><span class="instr-i">iiiii</span>
						</div>
					</div>
					<span class="instr-u">u</span> - Unused<br>
					<span class="instr-s">s</span> - Instruction set select<br>
					<span class="instr-r">r</span> - Register select<br>
					<span class="instr-i">i</span> - Instruction<br>
				</div>
				<h2>Instrunction table</h2>
				<div class="tab">
					<table>
						<tr>
							<th></th>
							<th>Instr</th>
							<th>Description</th>
						</tr>
						<tr>
							<td class="center-text">00</td>
							<td class="code-font">NOP</td>
							<td>Does nothing</td>
						</tr>
						<tr>
							<td class="center-text">01</td>
							<td class="code-font">RST</td>
							<td>Reset A,B,C,D and PC</td>
						</tr>
						<tr>
							<td class="center-text">02</td>
							<td class="code-font">RST</td>
							<td>Reset A,B,C,D and PC</td>
						</tr>
						<tr>
							<td class="center-text">04</td>
							<td class="code-font">-</td>
							<td class="code-font">-</td>
						</tr>
						<tr>
							<td class="center-text">05</td>
							<td class="code-font">-</td>
							<td class="code-font">-</td>
						</tr>
						<tr>
							<td class="center-text">06</td>
							<td class="code-font">LD <span class="instr-r">r</span>,A</td>
							<td>Load value of <span class="code-font">A</span> into <span class="instr-r">r</span></td>
						</tr>
						<tr>
							<td class="center-text">07</td>
							<td class="code-font">LD <span class="instr-r">r</span>,B</td>
							<td>Load value of <span class="code-font">B</span> into <span class="instr-r">r</span></td>
						</tr>
						<tr>
							<td class="center-text">08</td>
							<td class="code-font">LD <span class="instr-r">r</span>,C</td>
							<td>Load value of <span class="code-font">C</span> into <span class="instr-r">r</span></td>
						</tr>
						<tr>
							<td class="center-text">08</td>
							<td class="code-font">LD <span class="instr-r">r</span>,D</td>
							<td>Load value of <span class="code-font">D</span> into <span class="instr-r">r</span></td>
						</tr>
						<tr>
							<td class="center-text">0A</td>
							<td class="code-font">LD A,[<span class="instr-r">r</span>]</td>
							<td>Read mem at location <span class="instr-r">r</span> into <span class="code-font">A</span></td>
						</tr>
						<tr>
							<td class="center-text">0B</td>
							<td class="code-font">LD [<span class="instr-r">r</span>],A</td>
							<td>Write the value of <span class="code-font">A</span> to mem at location <span class="instr-r">r</span></td>
						</tr>
						<tr>
							<td class="center-text">0C</td>
							<td class="code-font">ADD A,<span class="instr-r">r</span></td>
							<td>Add the value of <span class="instr-r">r</span> to <span class="code-font">A</span></td>
						</tr>
						<tr>
							<td class="center-text">0D</td>
							<td class="code-font">SUB A,<span class="instr-r">r</span></td>
							<td>Subtract the value of <span class="instr-r">r</span> from <span class="code-font">A</span></td>
						</tr>
						<tr>
							<td class="center-text">0E</td>
							<td class="code-font">MUL A,<span class="instr-r">r</span></td>
							<td>Multiply <span class="code-font">A</span> by <span class="instr-r">r</span> and store the result in <span class="code-font">A</span></td>
						</tr>
						<tr>
							<td class="center-text">0F</td>
							<td class="code-font">CMP A,<span class="instr-r">r</span></td>
							<td>Compare <span class="instr-r">r</span> and <span class="code-font">A</span>. 0 - (<span class="code-font">A</span>==<span class="instr-r">r</span>); 2 - (<span class="code-font">A</span>><span class="instr-r">r</span>); 4 - (<span class="code-font">A</span><<span class="instr-r">r</span>)</td>
						</tr>
						<tr>
							<td class="center-text">10</td>
							<td class="code-font">JP <span class="instr-r">r</span></td>
							<td>Jump to <span class="instr-r">r</span></td>
						</tr>
						<tr>
							<td class="center-text">11</td>
							<td class="code-font">JP Z,<span class="instr-r">r</span></td>
							<td>Jump to <span class="instr-r">r</span> if Zero flag is set</td>
						</tr>
						<tr>
							<td class="center-text">12</td>
							<td class="code-font">JP NZ,<span class="instr-r">r</span></td>
							<td>Jump to <span class="instr-r">r</span> if Zero flag is not set</td>
						</tr>
						<tr id="_i_halt">
							<td class="center-text">13</td>
							<td class="code-font">IOHALT</td>
							<td>Wait for IO_WAKE tick</td>
						</tr>
						<tr id="_io_trig">
							<td class="center-text">14</td>
							<td class="code-font">IOTRIG</td>
							<td>Send a pulse to the I/O device</td>
						</tr>
						<tr>
							<td class="center-text">00</td>
							<td class="code-font">TODO</td>
							<td>TODO</td>
						</tr>
					</table>
					(Invalid instructions are equivalent to NOP)
				</div>
				<h3>This page is WIP</h3>
			</div>
		</main>
	</body>
</html>